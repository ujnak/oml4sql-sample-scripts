SQL> @oml4sql-classification-random-forest
SQL> -----------------------------------------------------------------------
SQL> --   Oracle Machine Learning for SQL (OML4SQL) 23ai
SQL> --
SQL> --   Classification - Random Forest Algorithm - dmrfdemo.sql
SQL> --
SQL> --   Copyright (c) 2024 Oracle Corporation and/or its affilitiates.
SQL> --
SQL> --  The Universal Permissive License (UPL), Version 1.0
SQL> --
SQL> --  https://oss.oracle.com/licenses/upl/
SQL> -----------------------------------------------------------------------
SQL> SET serveroutput ON
SQL> SET trimspool ON
SQL> SET pages 10000
SQL> SET linesize 420
SQL> SET echo ON
SQL> SET long 2000000000
警告: このLONG設定によってJavaメモリーの問題が発生する可能性があります。この設定を引き下げるか、Javaが使用できるメモリーを増やす(あるいはその両方)ことをお薦めします。
SQL>
SQL> -----------------------------------------------------------------------
SQL> --                            SAMPLE PROBLEM
SQL> -----------------------------------------------------------------------
SQL> -- Given demographic data about a set of customers, predict the
SQL> -- customer response to an affinity card program using a classifier
SQL> -- based on Random Forests algorithm.
SQL>
SQL> -----------------------------------------------------------------------
SQL> --                            SET UP AND ANALYZE THE DATA
SQL> -----------------------------------------------------------------------
SQL> -- The data for this sample is composed from base tables in SH Schema
SQL> -- (See Sample Schema Documentation) and presented through these views:
SQL> -- mining_data_build_parallel_v (build data)
SQL> -- mining_data_test_parallel_v  (test data)
SQL> -- mining_data_apply_parallel_v (apply data)
SQL> -- (See dmsh.sql for view definitions).
SQL>
SQL> -----------
SQL> -- ANALYSIS
SQL> -----------
SQL> -- These are the factors to consider for data analysis in random forest:
SQL> --
SQL> -- 1. Missing Value Treatment for Predictors
SQL> --
SQL> --    Decision Tree implementation in ODM handles missing predictor
SQL> --    values (by penalizing predictors which have missing values)
SQL> --    and missing target values (by simply discarding records with
SQL> --    missing target values).
SQL> --    Other options can be specified by using the ODMS_MISSING_VALUE_TREATMENT
SQL> --    setting.
SQL> --
SQL> -- 2. Binning high cardinality data
SQL> --    No data preparation for the types we accept is necessary - even
SQL> --    for high cardinality predictors.  Preprocessing to reduce the
SQL> --    cardinality (e.g., binning) can improve the performance of the build.
SQL> --
SQL> -- This demo is similar to the Decision Tree demo. But instead of building a
SQL> -- decision tree, we build a random forest.We need some additional settings for
SQL> -- building the random forest. The build and score steps for random forest
SQL> -- and decision tree are identical.
SQL> --
SQL> -----------------------------------------------------------------------
SQL> --                            BUILD THE MODEL
SQL> -----------------------------------------------------------------------
SQL>
SQL> -- Cleanup old model with same name for repeat runs
SQL> BEGIN DBMS_DATA_MINING.DROP_MODEL('RF_SH_Clas_Sample');
  2  EXCEPTION WHEN OTHERS THEN NULL; END;
  3  /

PL/SQLプロシージャが正常に完了しました。

SQL>
SQL> --------------------------------
SQL> -- PREPARE BUILD (TRAINING) DATA
SQL> --
SQL> -- The decision tree algorithm is very capable of handling data which
SQL> -- has not been specially prepared.  For this example, no data preparation
SQL> -- will be performed.
SQL> --
SQL>
SQL> -------------------
SQL> -- SPECIFY SETTINGS
SQL> --
SQL> -- Cleanup old settings table objects for repeat runs
SQL> BEGIN EXECUTE IMMEDIATE 'DROP TABLE rf_sh_sample_cost';
  2  EXCEPTION WHEN OTHERS THEN NULL; END;
  3  /

PL/SQLプロシージャが正常に完了しました。

SQL>
SQL> -- CREATE AND POPULATE A COST MATRIX TABLE
SQL> --
SQL> -- A cost matrix is used to influence the weighting of misclassification
SQL> -- during model creation (and scoring).
SQL> -- See Oracle Data Mining Concepts Guide for more details.
SQL> --
SQL> CREATE TABLE rf_sh_sample_cost (
  2    actual_target_value           NUMBER,
  3    predicted_target_value        NUMBER,
  4    cost                          NUMBER);

Table RF_SH_SAMPLE_COSTは作成されました。

SQL> INSERT INTO rf_sh_sample_cost VALUES (0,0,0);

1行挿入しました。

SQL> INSERT INTO rf_sh_sample_cost VALUES (0,1,1);

1行挿入しました。

SQL> INSERT INTO rf_sh_sample_cost VALUES (1,0,8);

1行挿入しました。

SQL> INSERT INTO rf_sh_sample_cost VALUES (1,1,0);

1行挿入しました。

SQL>
SQL> ---------------------
SQL> -- CREATE A NEW MODEL
SQL> --
SQL> -- Build a RF model
SQL> DECLARE
  2    v_setlst DBMS_DATA_MINING.SETTING_LIST;
  3  BEGIN
  4    v_setlst('ALGO_NAME')            := 'ALGO_RANDOM_FOREST';
  5    v_setlst('CLAS_COST_TABLE_NAME') := 'rf_sh_sample_cost';
  6    v_setlst('RFOR_NUM_TREES')       := '25';
  7
  8    -- Examples of other possible settings are:
  9    --v_setlst('RFOR_MTRY') := '5';
 10    -- rfor_mtry specifies the number of attributes that are to be
 11    -- randomly chosen for computing splits at each node of the trees in
 12    -- the forest.
 13    --v_setlst('RFOR_SAMPLING_RATIO')    := '0.5';
 14    --v_setlst('ODMS_RANDOM_SEED')       := '41';
 15    --v_setlst('TREE_IMPURITY_METRIC')   := 'TREE_IMPURITY_ENTROPY';
 16    --v_setlst('TREE_TERM_MAX_DEPTH')    := '5';
 17    --v_setlst('TREE_TERM_MINREC_SPLIT') := '5';
 18    --v_setlst('TREE_TERM_MINPCT_SPLIT') := '2';
 19    --v_setlst('TREE_TERM_MINREC_NODE')  := '5';
 20    --v_setlst('TREE_TERM_MINPCT_NODE')  := '0.05';
 21
 22    DBMS_DATA_MINING.CREATE_MODEL2(
 23      model_name          => 'RF_SH_Clas_Sample',
 24      mining_function     => 'CLASSIFICATION',
 25      data_query          => 'select * from mining_data_build_parallel_v',
 26      set_list            => v_setlst,
 27      case_id_column_name => 'cust_id',
 28      target_column_name  => 'affinity_card');
 29  END;
 30  /

PL/SQLプロシージャが正常に完了しました。

SQL>
SQL> -------------------------
SQL> -- DISPLAY MODEL SETTINGS
SQL> --
SQL> column setting_name format a30
SQL> column setting_value format a30
SQL> SELECT setting_name, setting_value
  2    FROM user_mining_model_settings
  3   WHERE model_name = 'RF_SH_CLAS_SAMPLE'
  4  ORDER BY setting_name;

SETTING_NAME                   SETTING_VALUE
------------------------------ ------------------------------
ALGO_NAME                      ALGO_RANDOM_FOREST
CLAS_COST_TABLE_NAME           rf_sh_sample_cost
CLAS_MAX_SUP_BINS              32
CLAS_WEIGHTS_BALANCED          OFF
ODMS_DETAILS                   ODMS_ENABLE
ODMS_MISSING_VALUE_TREATMENT   ODMS_MISSING_VALUE_AUTO
ODMS_RANDOM_SEED               0
ODMS_SAMPLING                  ODMS_SAMPLING_DISABLE
PREP_AUTO                      ON
RFOR_NUM_TREES                 25
RFOR_SAMPLING_RATIO            .5
TREE_IMPURITY_METRIC           TREE_IMPURITY_GINI
TREE_TERM_MAX_DEPTH            16
TREE_TERM_MINPCT_NODE          .05
TREE_TERM_MINPCT_SPLIT         .1
TREE_TERM_MINREC_NODE          10
TREE_TERM_MINREC_SPLIT         20

17行が選択されました。

SQL>
SQL> --------------------------
SQL> -- DISPLAY MODEL SIGNATURE
SQL> --
SQL> column attribute_name format a40
SQL> column attribute_type format a20
SQL> SELECT attribute_name, attribute_type
  2    FROM user_mining_model_attributes
  3   WHERE model_name = 'RF_SH_CLAS_SAMPLE'
  4  ORDER BY attribute_name;

ATTRIBUTE_NAME                           ATTRIBUTE_TYPE
---------------------------------------- --------------------
AFFINITY_CARD                            CATEGORICAL
AGE                                      NUMERICAL
BOOKKEEPING_APPLICATION                  NUMERICAL
BULK_PACK_DISKETTES                      NUMERICAL
CUST_GENDER                              CATEGORICAL
CUST_MARITAL_STATUS                      CATEGORICAL
EDUCATION                                CATEGORICAL
FLAT_PANEL_MONITOR                       NUMERICAL
HOME_THEATER_PACKAGE                     NUMERICAL
HOUSEHOLD_SIZE                           CATEGORICAL
OCCUPATION                               CATEGORICAL
YRS_RESIDENCE                            NUMERICAL
Y_BOX_GAMES                              NUMERICAL

13行が選択されました。

SQL>
SQL> --------------------------
SQL> -- DISPLAY MODEL VIEWS
SQL> --
SQL>
SQL> -- Get a list of model views
SQL> col view_name format a30
SQL> col view_type format a50
SQL> SELECT view_name, view_type FROM user_mining_model_views
  2    WHERE model_name='RF_SH_CLAS_SAMPLE'
  3    ORDER BY view_name;

VIEW_NAME                      VIEW_TYPE
------------------------------ --------------------------------------------------
DM$VARF_SH_CLAS_SAMPLE         Variable Importance
DM$VCRF_SH_CLAS_SAMPLE         Scoring Cost Matrix
DM$VGRF_SH_CLAS_SAMPLE         Global Name-Value Pairs
DM$VSRF_SH_CLAS_SAMPLE         Computed Settings
DM$VTRF_SH_CLAS_SAMPLE         Classification Targets
DM$VWRF_SH_CLAS_SAMPLE         Model Build Alerts

6行が選択されました。

SQL>
SQL> ------------------------
SQL> -- DISPLAY MODEL metdata
SQL> --
SQL> column string_value format a12
SQL> column setting_name format a12
SQL> column setting_value format a14
SQL>
SQL> select name, numeric_value, string_value from DM$VGRF_SH_CLAS_SAMPLE
  2  order by name;

NAME                           NUMERIC_VALUE STRING_VALUE
------------------------------ ------------- ------------
AVG_DEPTH                             10.520
AVG_NODECOUNT                         78.360
MAX_DEPTH                             13.000
MAX_NODECOUNT                         87.000
MIN_DEPTH                             12.000
MIN_NODECOUNT                         67.000
NUM_ROWS                            1500.000

7行が選択されました。

SQL>
SQL> -- Get computed settings --
SQL> select setting_name, setting_value from DM$VSRF_SH_CLAS_SAMPLE;

SETTING_NAME SETTING_VALUE
------------ --------------
RFOR_MTRY    8

SQL>
SQL> --Get variable importance for the forest --
SQL> column attribute_name format a30
SQL> select attribute_name, attribute_importance
  2  from DM$VARF_SH_CLAS_SAMPLE
  3  order by  attribute_importance desc, attribute_name asc;

ATTRIBUTE_NAME                 ATTRIBUTE_IMPORTANCE
------------------------------ --------------------
AGE                                      1.143E+000
EDUCATION                                9.622E-001
OCCUPATION                               7.733E-001
YRS_RESIDENCE                            7.687E-001
HOUSEHOLD_SIZE                           6.328E-001
CUST_MARITAL_STATUS                      4.171E-001
Y_BOX_GAMES                              2.747E-001
FLAT_PANEL_MONITOR                        1.91E-001
BULK_PACK_DISKETTES                      1.644E-001
BOOKKEEPING_APPLICATION                  1.172E-001
CUST_GENDER                              9.886E-002
HOME_THEATER_PACKAGE                     6.235E-002
COUNTRY_NAME                                      0
CUST_INCOME_LEVEL                                 0
OS_DOC_SET_KANJI                                  0
PRINTER_SUPPLIES                                  0

16行が選択されました。

SQL>
SQL> -----------------------------------------------------------------------
SQL> --                               TEST THE MODEL
SQL> -----------------------------------------------------------------------
SQL>
SQL> --------------------
SQL> -- PREPARE TEST DATA
SQL> --
SQL> -- If the data for model creation has been prepared, then the data used
SQL> -- for testing the model must be prepared to the same scale in order to
SQL> -- obtain meaningful results.
SQL> -- In this case, no data preparation is necessary since model creation
SQL> -- was performed on the raw (unprepared) input.
SQL> --
SQL>
SQL> ------------------------------------
SQL> -- COMPUTE METRICS TO TEST THE MODEL
SQL> --
SQL> -- Other demo programs demonstrate how to use the PL/SQL API to
SQL> -- compute a number of metrics, including lift and ROC.  This demo
SQL> -- only computes a confusion matrix and accuracy, but it does so
SQL> -- using the SQL data mining functions.
SQL> --
SQL> -- In this example, we experiment with using the cost matrix
SQL> -- that was provided to the create routine.  In this example, the
SQL> -- cost matrix reduces the problematic misclassifications, but also
SQL> -- negatively impacts the overall model accuracy.
SQL>
SQL> -- DISPLAY CONFUSION MATRIX WITHOUT APPLYING COST MATRIX
SQL> --
SQL> SELECT affinity_card AS actual_target_value,
  2         PREDICTION(RF_SH_Clas_Sample USING *) AS predicted_target_value,
  3         COUNT(*) AS value
  4    FROM mining_data_test_parallel_v
  5  GROUP BY affinity_card, PREDICTION(RF_SH_Clas_Sample USING *)
  6  ORDER BY 1,2;

ACTUAL_TARGET_VALUE PREDICTED_TARGET_VALUE      VALUE
------------------- ---------------------- ----------
                  0                      0       1055
                  0                      1         99
                  1                      0        150
                  1                      1        196

SQL>
SQL> -- DISPLAY CONFUSION MATRIX APPLYING THE COST MATRIX
SQL> --
SQL> SELECT affinity_card AS actual_target_value,
  2         PREDICTION(RF_SH_Clas_Sample COST MODEL USING *)
  3           AS predicted_target_value,
  4         COUNT(*) AS value
  5    FROM mining_data_test_parallel_v
  6  GROUP BY affinity_card, PREDICTION(RF_SH_Clas_Sample COST MODEL USING *)
  7  ORDER BY 1,2;

ACTUAL_TARGET_VALUE PREDICTED_TARGET_VALUE      VALUE
------------------- ---------------------- ----------
                  0                      0        661
                  0                      1        493
                  1                      0         23
                  1                      1        323

SQL>
SQL> -- DISPLAY ACCURACY WITHOUT APPLYING COST MATRIX
SQL> --
SQL> SELECT ROUND(SUM(correct)/COUNT(*),4) AS accuracy
  2    FROM (SELECT DECODE(affinity_card,
  3                 PREDICTION(RF_SH_Clas_Sample USING *), 1, 0) AS correct
  4            FROM mining_data_test_parallel_v);

ACCURACY
--------
     .83

SQL>
SQL> -- DISPLAY ACCURACY APPLYING THE COST MATRIX
SQL> --
SQL> SELECT ROUND(SUM(correct)/COUNT(*),4) AS accuracy
  2    FROM (SELECT DECODE(affinity_card,
  3                   PREDICTION(RF_SH_Clas_Sample COST MODEL USING *),
  4                   1, 0) AS correct
  5            FROM mining_data_test_parallel_v);

ACCURACY
--------
     .66

SQL>
SQL> -----------------------------------------------------------------------
SQL> --                               APPLY THE MODEL
SQL> -----------------------------------------------------------------------
SQL>
SQL> ------------------
SQL> -- BUSINESS CASE 1
SQL> -- Find the 10 customers who live in Italy that are least expensive
SQL> -- to be convinced to use an affinity card.
SQL> --
SQL> SELECT cust_id FROM
  2  (SELECT cust_id,
  3          rank() over (order by PREDICTION_COST(RF_SH_Clas_Sample,
  4                       1 COST MODEL USING *) ASC, cust_id) rnk
  5     FROM mining_data_apply_parallel_v
  6    WHERE country_name = 'Italy')
  7  where rnk <= 10
  8  order by rnk;

   CUST_ID
----------
    100733
    100179
    101445
    100662
    100554
    100081
    100344
    100185
    100324
    101345

10行が選択されました。

SQL>
SQL> ------------------
SQL> -- BUSINESS CASE 2
SQL> -- Find the average age of customers who are likely to use an
SQL> -- affinity card.
SQL> -- Include the build-time cost matrix in the prediction.
SQL> -- Only take into account CUST_MARITAL_STATUS, EDUCATION, and
SQL> -- HOUSEHOLD_SIZE as predictors.
SQL> -- Break out the results by gender.
SQL> --
SQL> column cust_gender format a12
SQL> SELECT cust_gender, COUNT(*) AS cnt, ROUND(AVG(age)) AS avg_age
  2    FROM mining_data_apply_parallel_v
  3   WHERE PREDICTION(rf_sh_clas_sample COST MODEL
  4                   USING cust_marital_status, education, household_size) = 1
  5  GROUP BY cust_gender
  6  ORDER BY cust_gender;

CUST_GENDER         CNT    AVG_AGE
------------ ---------- ----------
F                   179         27
M                   697         31

SQL>
SQL> ------------------
SQL> -- BUSINESS CASE 3
SQL> -- List ten customers (ordered by their id) along with likelihood and cost
SQL> -- to use or reject the affinity card (Note: while this example has a
SQL> -- binary target, such a query is useful in multi-class classification -
SQL> -- Low, Med, High for example).
SQL> --
SQL> column prediction format 9
SQL> column probability format 9.999999999
SQL> column cost format 9.999999999
SQL> SELECT T.cust_id, S.prediction, S.probability, S.cost
  2    FROM (SELECT cust_id,
  3                 PREDICTION_SET(rf_sh_clas_sample COST MODEL USING *) pset
  4            FROM mining_data_apply_parallel_v
  5           WHERE cust_id < 100011) T,
  6         TABLE(T.pset) S
  7  ORDER BY cust_id, S.prediction;

   CUST_ID PREDICTION PROBABILITY COST
---------- ---------- ----------- ----
    100001          0  .948402698 .412778417
    100001          1  .051597302 .948402698
    100002          0  .715904614 2.272763087
    100002          1  .284095386 .715904614
    100003          0  .863840025 1.089279796
    100003          1  .136159975 .863840025
    100004          0  .931958917 .544328665
    100004          1  .068041083 .931958917
    100005          0  .361959084 5.104327328
    100005          1  .638040916 .361959084
    100006          0 1.000000000 .000000000
    100006          1  .000000000 1.000000000
    100007          0  .967496947 .260024420
    100007          1  .032503053 .967496947
    100008          0  .852234559 1.182123528
    100008          1  .147765441 .852234559
    100009          0  .385156464 4.918748291
    100009          1  .614843536 .385156464
    100010          0  .858233927 1.134128581
    100010          1  .141766073 .858233927

20行が選択されました。

SQL>
SQL> ------------------
SQL> -- BUSINESS CASE 4
SQL> -- Find the segmentation (prediction and rule) for customers who
SQL> -- work in Tech support and are under 25.
SQL> --
SQL> set long 20000
SQL> set line 300
SQL> set pagesize 100
SQL> column education format a30
SQL> SELECT cust_id, education,
  2         PREDICTION_DETAILS(rf_sh_clas_sample USING *) prediction_details
  3    FROM mining_data_apply_parallel_v
  4   WHERE occupation = 'TechSup' AND age < 25
  5  ORDER BY cust_id;

   CUST_ID EDUCATION                      PREDICTION_DETAILS
---------- ------------------------------ --------------------------------------------------------------------------------
    100099 HS-grad                        <Details algorithm="" class="0">
                                          <Attribute name="YRS_RESIDENCE" actualValue="3" weight="2.245" rank="1"/>
                                          <Attribute name="AGE" actualValue="19" weight=".407" rank="2"/>
                                          <Attribute name="FLAT_PANEL_MONITOR" actualValue="1" weight=".244" rank="3"/>
                                          <Attribute name="BULK_PACK_DISKETTES" actualValue="1" weight=".128" rank="4"/>
                                          <Attribute name="EDUCATION" actualValue="HS-grad" weight=".094" rank="5"/>
                                          </Details>

    100125 Bach.                          <Details algorithm="" class="0">
                                          <Attribute name="YRS_RESIDENCE" actualValue="1" weight="1.13" rank="1"/>
                                          <Attribute name="FLAT_PANEL_MONITOR" actualValue="0" weight=".725" rank="2"/>
                                          <Attribute name="Y_BOX_GAMES" actualValue="1" weight=".682" rank="3"/>
                                          <Attribute name="HOUSEHOLD_SIZE" actualValue="1" weight=".104" rank="4"/>
                                          <Attribute name="CUST_MARITAL_STATUS" actualValue="never married" weight=".069"
                                          rank="5"/>
                                          </Details>

    100152 HS-grad                        <Details algorithm="" class="0">
                                          <Attribute name="YRS_RESIDENCE" actualValue="3" weight="2.761" rank="1"/>
                                          <Attribute name="EDUCATION" actualValue="HS-grad" weight=".093" rank="2"/>
                                          <Attribute name="OCCUPATION" actualValue="TechSup" weight=".046" rank="3"/>
                                          <Attribute name="CUST_GENDER" actualValue="F" weight="-.011" rank="4"/>
                                          <Attribute name="CUST_MARITAL_STATUS" actualValue="married" weight="-.09" rank="
                                          5"/>
                                          </Details>

    100187 < Bach.                        <Details algorithm="" class="0">
                                          <Attribute name="AGE" actualValue="14" weight=".964" rank="1"/>
                                          <Attribute name="Y_BOX_GAMES" actualValue="1" weight=".692" rank="2"/>
                                          <Attribute name="YRS_RESIDENCE" actualValue="3" weight=".445" rank="3"/>
                                          <Attribute name="HOUSEHOLD_SIZE" actualValue="1" weight=".087" rank="4"/>
                                          <Attribute name="CUST_MARITAL_STATUS" actualValue="divorced" weight=".071" rank=
                                          "5"/>
                                          </Details>

    100202 < Bach.                        <Details algorithm="" class="0">
                                          <Attribute name="YRS_RESIDENCE" actualValue="3" weight=".998" rank="1"/>
                                          <Attribute name="HOUSEHOLD_SIZE" actualValue="2" weight=".101" rank="2"/>
                                          <Attribute name="CUST_MARITAL_STATUS" actualValue="never married" weight=".072"
                                          rank="3"/>
                                          <Attribute name="EDUCATION" actualValue="&lt; Bach." weight=".029" rank="4"/>
                                          <Attribute name="FLAT_PANEL_MONITOR" actualValue="1" weight=".014" rank="5"/>
                                          </Details>

    100234 < Bach.                        <Details algorithm="" class="0">
                                          <Attribute name="AGE" actualValue="9" weight=".92" rank="1"/>
                                          <Attribute name="YRS_RESIDENCE" actualValue="2" weight=".675" rank="2"/>
                                          <Attribute name="Y_BOX_GAMES" actualValue="1" weight=".628" rank="3"/>
                                          <Attribute name="HOUSEHOLD_SIZE" actualValue="2" weight=".083" rank="4"/>
                                          <Attribute name="CUST_MARITAL_STATUS" actualValue="never married" weight=".067"
                                          rank="5"/>
                                          </Details>

    100259 < Bach.                        <Details algorithm="" class="0">
                                          <Attribute name="YRS_RESIDENCE" actualValue="3" weight="2.245" rank="1"/>
                                          <Attribute name="AGE" actualValue="23" weight="1.308" rank="2"/>
                                          <Attribute name="BULK_PACK_DISKETTES" actualValue="1" weight=".228" rank="3"/>
                                          <Attribute name="FLAT_PANEL_MONITOR" actualValue="1" weight=".132" rank="4"/>
                                          <Attribute name="EDUCATION" actualValue="&lt; Bach." weight=".098" rank="5"/>
                                          </Details>

    100304 Assoc-A                        <Details algorithm="" class="0">
                                          <Attribute name="YRS_RESIDENCE" actualValue="3" weight="1.158" rank="1"/>
                                          <Attribute name="FLAT_PANEL_MONITOR" actualValue="0" weight=".864" rank="2"/>
                                          <Attribute name="BULK_PACK_DISKETTES" actualValue="0" weight=".236" rank="3"/>
                                          <Attribute name="HOUSEHOLD_SIZE" actualValue="2" weight=".103" rank="4"/>
                                          <Attribute name="HOME_THEATER_PACKAGE" actualValue="0" weight=".099" rank="5"/>
                                          </Details>

    100320 < Bach.                        <Details algorithm="" class="0">
                                          <Attribute name="AGE" actualValue="13" weight=".92" rank="1"/>
                                          <Attribute name="YRS_RESIDENCE" actualValue="2" weight=".675" rank="2"/>
                                          <Attribute name="Y_BOX_GAMES" actualValue="1" weight=".628" rank="3"/>
                                          <Attribute name="HOUSEHOLD_SIZE" actualValue="2" weight=".083" rank="4"/>
                                          <Attribute name="CUST_MARITAL_STATUS" actualValue="never married" weight=".067"
                                          rank="5"/>
                                          </Details>

    100349 < Bach.                        <Details algorithm="" class="0">
                                          <Attribute name="AGE" actualValue="13" weight=".869" rank="1"/>
                                          <Attribute name="Y_BOX_GAMES" actualValue="1" weight=".692" rank="2"/>
                                          <Attribute name="YRS_RESIDENCE" actualValue="1" weight=".682" rank="3"/>
                                          <Attribute name="HOUSEHOLD_SIZE" actualValue="1" weight=".087" rank="4"/>
                                          <Attribute name="CUST_MARITAL_STATUS" actualValue="never married" weight=".067"
                                          rank="5"/>
                                          </Details>

    100419 < Bach.                        <Details algorithm="" class="0">
                                          <Attribute name="AGE" actualValue="10" weight=".88" rank="1"/>
                                          <Attribute name="Y_BOX_GAMES" actualValue="1" weight=".692" rank="2"/>
                                          <Attribute name="YRS_RESIDENCE" actualValue="1" weight=".682" rank="3"/>
                                          <Attribute name="HOUSEHOLD_SIZE" actualValue="1" weight=".09" rank="4"/>
                                          <Attribute name="CUST_MARITAL_STATUS" actualValue="never married" weight=".067"
                                          rank="5"/>
                                          </Details>

    100448 HS-grad                        <Details algorithm="" class="0">

   CUST_ID EDUCATION                      PREDICTION_DETAILS
---------- ------------------------------ --------------------------------------------------------------------------------
                                          <Attribute name="YRS_RESIDENCE" actualValue="3" weight="2.761" rank="1"/>
                                          <Attribute name="EDUCATION" actualValue="HS-grad" weight=".098" rank="2"/>
                                          <Attribute name="OCCUPATION" actualValue="TechSup" weight=".047" rank="3"/>
                                          <Attribute name="CUST_GENDER" actualValue="M" weight=".002" rank="4"/>
                                          <Attribute name="CUST_MARITAL_STATUS" actualValue="married" weight="-.09" rank="
                                          5"/>
                                          </Details>

    100489 Assoc-A                        <Details algorithm="" class="0">
                                          <Attribute name="AGE" actualValue="14" weight="1.664" rank="1"/>
                                          <Attribute name="Y_BOX_GAMES" actualValue="1" weight=".649" rank="2"/>
                                          <Attribute name="YRS_RESIDENCE" actualValue="3" weight=".577" rank="3"/>
                                          <Attribute name="HOUSEHOLD_SIZE" actualValue="1" weight=".098" rank="4"/>
                                          <Attribute name="CUST_MARITAL_STATUS" actualValue="never married" weight=".069"
                                          rank="5"/>
                                          </Details>

    100583 < Bach.                        <Details algorithm="" class="0">
                                          <Attribute name="AGE" actualValue="13" weight="4.086" rank="1"/>
                                          <Attribute name="YRS_RESIDENCE" actualValue="2" weight="2.375" rank="2"/>
                                          <Attribute name="Y_BOX_GAMES" actualValue="1" weight="1.521" rank="3"/>
                                          <Attribute name="EDUCATION" actualValue="&lt; Bach." weight=".065" rank="4"/>
                                          <Attribute name="OCCUPATION" actualValue="TechSup" weight=".022" rank="5"/>
                                          </Details>

    100643 Bach.                          <Details algorithm="" class="0">
                                          <Attribute name="AGE" actualValue="14" weight="1.594" rank="1"/>
                                          <Attribute name="Y_BOX_GAMES" actualValue="1" weight=".589" rank="2"/>
                                          <Attribute name="YRS_RESIDENCE" actualValue="3" weight=".538" rank="3"/>
                                          <Attribute name="FLAT_PANEL_MONITOR" actualValue="0" weight=".454" rank="4"/>
                                          <Attribute name="HOUSEHOLD_SIZE" actualValue="2" weight=".08" rank="5"/>
                                          </Details>

    100657 HS-grad                        <Details algorithm="" class="0">
                                          <Attribute name="AGE" actualValue="7" weight=".869" rank="1"/>
                                          <Attribute name="Y_BOX_GAMES" actualValue="1" weight=".692" rank="2"/>
                                          <Attribute name="YRS_RESIDENCE" actualValue="0" weight=".682" rank="3"/>
                                          <Attribute name="HOUSEHOLD_SIZE" actualValue="1" weight=".088" rank="4"/>
                                          <Attribute name="CUST_MARITAL_STATUS" actualValue="never married" weight=".067"
                                          rank="5"/>
                                          </Details>

    100670 < Bach.                        <Details algorithm="" class="0">
                                          <Attribute name="Y_BOX_GAMES" actualValue="1" weight=".73" rank="1"/>
                                          <Attribute name="YRS_RESIDENCE" actualValue="3" weight=".539" rank="2"/>
                                          <Attribute name="HOUSEHOLD_SIZE" actualValue="2" weight=".089" rank="3"/>
                                          <Attribute name="CUST_MARITAL_STATUS" actualValue="never married" weight=".063"
                                          rank="4"/>
                                          <Attribute name="EDUCATION" actualValue="&lt; Bach." weight=".032" rank="5"/>
                                          </Details>

    100824 Bach.                          <Details algorithm="" class="0">
                                          <Attribute name="AGE" actualValue="14" weight="1.664" rank="1"/>
                                          <Attribute name="Y_BOX_GAMES" actualValue="1" weight=".649" rank="2"/>
                                          <Attribute name="YRS_RESIDENCE" actualValue="3" weight=".577" rank="3"/>
                                          <Attribute name="HOUSEHOLD_SIZE" actualValue="9+" weight=".084" rank="4"/>
                                          <Attribute name="CUST_MARITAL_STATUS" actualValue="never married" weight=".069"
                                          rank="5"/>
                                          </Details>

    100851 HS-grad                        <Details algorithm="" class="0">
                                          <Attribute name="AGE" actualValue="14" weight=".964" rank="1"/>
                                          <Attribute name="Y_BOX_GAMES" actualValue="1" weight=".692" rank="2"/>
                                          <Attribute name="YRS_RESIDENCE" actualValue="3" weight=".445" rank="3"/>
                                          <Attribute name="HOUSEHOLD_SIZE" actualValue="9+" weight=".087" rank="4"/>
                                          <Attribute name="CUST_MARITAL_STATUS" actualValue="divorced" weight=".071" rank=
                                          "5"/>
                                          </Details>

    100952 Bach.                          <Details algorithm="" class="0">
                                          <Attribute name="AGE" actualValue="14" weight="1.594" rank="1"/>
                                          <Attribute name="Y_BOX_GAMES" actualValue="1" weight=".589" rank="2"/>
                                          <Attribute name="YRS_RESIDENCE" actualValue="3" weight=".538" rank="3"/>
                                          <Attribute name="FLAT_PANEL_MONITOR" actualValue="0" weight=".454" rank="4"/>
                                          <Attribute name="HOUSEHOLD_SIZE" actualValue="2" weight=".08" rank="5"/>
                                          </Details>

    100993 Assoc-V                        <Details algorithm="" class="0">
                                          <Attribute name="Y_BOX_GAMES" actualValue="1" weight=".73" rank="1"/>
                                          <Attribute name="YRS_RESIDENCE" actualValue="3" weight=".539" rank="2"/>
                                          <Attribute name="HOUSEHOLD_SIZE" actualValue="2" weight=".091" rank="3"/>
                                          <Attribute name="CUST_MARITAL_STATUS" actualValue="never married" weight=".063"
                                          rank="4"/>
                                          <Attribute name="BULK_PACK_DISKETTES" actualValue="1" weight=".042" rank="5"/>
                                          </Details>

    101043 Assoc-V                        <Details algorithm="" class="0">
                                          <Attribute name="YRS_RESIDENCE" actualValue="3" weight=".935" rank="1"/>
                                          <Attribute name="HOUSEHOLD_SIZE" actualValue="9+" weight=".123" rank="2"/>
                                          <Attribute name="CUST_MARITAL_STATUS" actualValue="divorced" weight=".081" rank=
                                          "3"/>
                                          <Attribute name="EDUCATION" actualValue="Assoc-V" weight=".028" rank="4"/>
                                          <Attribute name="CUST_GENDER" actualValue="F" weight=".009" rank="5"/>
                                          </Details>

    101158 Bach.                          <Details algorithm="" class="0">
                                          <Attribute name="AGE" actualValue="14" weight="1.613" rank="1"/>

   CUST_ID EDUCATION                      PREDICTION_DETAILS
---------- ------------------------------ --------------------------------------------------------------------------------
                                          <Attribute name="YRS_RESIDENCE" actualValue="1" weight="1.123" rank="2"/>
                                          <Attribute name="Y_BOX_GAMES" actualValue="1" weight=".649" rank="3"/>
                                          <Attribute name="HOUSEHOLD_SIZE" actualValue="1" weight=".086" rank="4"/>
                                          <Attribute name="CUST_MARITAL_STATUS" actualValue="never married" weight=".069"
                                          rank="5"/>
                                          </Details>

    101171 < Bach.                        <Details algorithm="" class="0">
                                          <Attribute name="AGE" actualValue="11" weight=".914" rank="1"/>
                                          <Attribute name="YRS_RESIDENCE" actualValue="2" weight=".675" rank="2"/>
                                          <Attribute name="Y_BOX_GAMES" actualValue="1" weight=".628" rank="3"/>
                                          <Attribute name="HOUSEHOLD_SIZE" actualValue="2" weight=".085" rank="4"/>
                                          <Attribute name="CUST_MARITAL_STATUS" actualValue="never married" weight=".067"
                                          rank="5"/>
                                          </Details>

    101218 Bach.                          <Details algorithm="" class="0">
                                          <Attribute name="YRS_RESIDENCE" actualValue="3" weight="1.103" rank="1"/>
                                          <Attribute name="FLAT_PANEL_MONITOR" actualValue="0" weight=".864" rank="2"/>
                                          <Attribute name="BULK_PACK_DISKETTES" actualValue="0" weight=".236" rank="3"/>
                                          <Attribute name="HOUSEHOLD_SIZE" actualValue="2" weight=".103" rank="4"/>
                                          <Attribute name="HOME_THEATER_PACKAGE" actualValue="0" weight=".099" rank="5"/>
                                          </Details>

    101222 Assoc-V                        <Details algorithm="" class="0">
                                          <Attribute name="AGE" actualValue="14" weight=".964" rank="1"/>
                                          <Attribute name="Y_BOX_GAMES" actualValue="1" weight=".702" rank="2"/>
                                          <Attribute name="YRS_RESIDENCE" actualValue="3" weight=".445" rank="3"/>
                                          <Attribute name="HOUSEHOLD_SIZE" actualValue="9+" weight=".087" rank="4"/>
                                          <Attribute name="CUST_MARITAL_STATUS" actualValue="never married" weight=".063"
                                          rank="5"/>
                                          </Details>

    101225 < Bach.                        <Details algorithm="" class="0">
                                          <Attribute name="AGE" actualValue="11" weight=".869" rank="1"/>
                                          <Attribute name="Y_BOX_GAMES" actualValue="1" weight=".692" rank="2"/>
                                          <Attribute name="YRS_RESIDENCE" actualValue="2" weight=".682" rank="3"/>
                                          <Attribute name="HOUSEHOLD_SIZE" actualValue="1" weight=".087" rank="4"/>
                                          <Attribute name="CUST_MARITAL_STATUS" actualValue="never married" weight=".067"
                                          rank="5"/>
                                          </Details>

    101338 < Bach.                        <Details algorithm="" class="0">
                                          <Attribute name="AGE" actualValue="11" weight=".869" rank="1"/>
                                          <Attribute name="Y_BOX_GAMES" actualValue="1" weight=".692" rank="2"/>
                                          <Attribute name="YRS_RESIDENCE" actualValue="2" weight=".682" rank="3"/>
                                          <Attribute name="HOUSEHOLD_SIZE" actualValue="6-8" weight=".087" rank="4"/>
                                          <Attribute name="CUST_MARITAL_STATUS" actualValue="never married" weight=".067"
                                          rank="5"/>
                                          </Details>

    101405 Bach.                          <Details algorithm="" class="0">
                                          <Attribute name="Y_BOX_GAMES" actualValue="1" weight=".682" rank="1"/>
                                          <Attribute name="AGE" actualValue="16" weight=".587" rank="2"/>
                                          <Attribute name="YRS_RESIDENCE" actualValue="3" weight=".584" rank="3"/>
                                          <Attribute name="FLAT_PANEL_MONITOR" actualValue="0" weight=".476" rank="4"/>
                                          <Attribute name="HOUSEHOLD_SIZE" actualValue="1" weight=".115" rank="5"/>
                                          </Details>

    101422 Assoc-A                        <Details algorithm="" class="1">
                                          <Attribute name="Y_BOX_GAMES" actualValue="0" weight=".355" rank="1"/>
                                          <Attribute name="EDUCATION" actualValue="Assoc-A" weight=".284" rank="2"/>
                                          <Attribute name="BULK_PACK_DISKETTES" actualValue="1" weight=".214" rank="3"/>
                                          <Attribute name="HOUSEHOLD_SIZE" actualValue="3" weight=".114" rank="4"/>
                                          <Attribute name="CUST_MARITAL_STATUS" actualValue="married" weight=".09" rank="5
                                          "/>
                                          </Details>

    101438 HS-grad                        <Details algorithm="" class="0">
                                          <Attribute name="YRS_RESIDENCE" actualValue="3" weight="2" rank="1"/>
                                          <Attribute name="Y_BOX_GAMES" actualValue="1" weight="1.969" rank="2"/>
                                          <Attribute name="AGE" actualValue="16" weight="1.557" rank="3"/>
                                          <Attribute name="EDUCATION" actualValue="HS-grad" weight=".091" rank="4"/>
                                          <Attribute name="OCCUPATION" actualValue="TechSup" weight=".038" rank="5"/>
                                          </Details>

    101480 < Bach.                        <Details algorithm="" class="0">
                                          <Attribute name="Y_BOX_GAMES" actualValue="1" weight=".782" rank="1"/>
                                          <Attribute name="YRS_RESIDENCE" actualValue="1" weight=".721" rank="2"/>
                                          <Attribute name="HOUSEHOLD_SIZE" actualValue="2" weight=".089" rank="3"/>
                                          <Attribute name="CUST_MARITAL_STATUS" actualValue="divorced" weight=".067" rank=
                                          "4"/>
                                          <Attribute name="BULK_PACK_DISKETTES" actualValue="1" weight=".031" rank="5"/>
                                          </Details>


32行が選択されました。

SQL> spool oml4sql-classification-regression-xgboost
